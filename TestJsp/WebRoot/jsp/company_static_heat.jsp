<%@ page pageEncoding="UTF-8"%>

<html>
<head>

<%  
String path = request.getContextPath();  
String basePath = request.getScheme()+"://"+request.getServerName()+":"+request.getServerPort()+path+"/";  
%>  
<base href="<%=basePath%>"/>

<title></title>

<!-- ECharts单文件引入 -->

<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/echarts.min.js"></script>
<body>
	<!-- 为ECharts准备一个具备大小（宽高）的Dom -->
	<div id="main" style="width: 100%; height: 100%"></div>
	<script type="text/javascript">
	
	setTimeout(function()
	{
		var myChart = echarts.init(document.getElementById('main'));
		
		myChart.showLoading({
			text : '数据读取中...',
		});

		var hours = ['小计',
		             '市地税局',
		             '市工商局',
		             '市食品药品监管局',
		             '市高级法院',
		             '市环保局',
		             '市质量技监局',
		             '市建设管理委',
		             '市交通委',
		             '市水务局（市海洋局)',
		             '上海海关',
		             '市安全监管局',
		             '市规划国土资源局',
		             '市卫生计生委',
		             '市烟草专卖局',
		             '市电力办',
		             '市绿化市容局',
		             '市发展改革委',
		             '上海海事局',
		             '市公安局',
		             '市人力资源社会保障局',
		             '市统计局',
		             '市民防办公室',
		             '华东能源局',
		             '市财政局',
		             '市知识产权局',
		             '市无线电管理局'];
		     var days = ['长宁', '闵行', '宝山', '黄浦', '徐汇',
							'浦东',  '普陀', '嘉定', '松江',
							'崇明', '金山', '虹口', '青浦', '静安',
							'杨浦', '奉贤','小计'];
		     var orgMap={0:'上海市',
		    		 1:'市地税局',
		    		 2:'市工商局',
		    		 3:'市食品药品监管局',
		    		 4:'市高级法院',
		    		 5:'市环保局',
		    		 6:'市质量技监局',
		    		 7:'市建设管理委',
		    		 8:'市交通委',
		    		 9:'市水务局（市海洋局)',
		    		 10:'上海海关',
		    		 11:'市安全监管局',
		    		 12:'市规划国土资源局',
		    		 13:'市卫生计生委',
		    		 14:'市烟草专卖局',
		    		 15:'市电力办',
		    		 16:'市绿化市容局',
		    		 17:'市发展改革委',
		    		 18:'上海海事局',
		    		 19:'市公安局',
		    		 20:'市人力资源社会保障局',
		    		 21:'市统计局',
		    		 22:'市民防办公室',
		    		 23:'华东能源局',
		    		 24:'市财政局',
		    		 25:'市知识产权局',
		    		 26:'市无线电管理局'};

		     var data = [ [0,0,668],[0,1,3921],[0,2,3247],[0,3,1138],[0,4,1222],[0,5,3603],[0,6,1058],[0,7,6002],[0,8,996],[0,9,1427],[0,10,2580],[0,11,1228],[0,12,1794],[0,13,3022],[0,14,1506],[0,15,1933],[0,16,35345],
[1,0,267],[1,1,2870],[1,2,2127],[1,3,709],[1,4,762],[1,5,1906],[1,6,540],[1,7,4682],[1,8,650],[1,9,884],[1,10,2123],[1,11,766],[1,12,1366],[1,13,2132],[1,14,974],[1,15,1482],[1,16,24240],
[2,0,103],[2,1,215],[2,2,285],[2,3,69],[2,4,100],[2,5,362],[2,6,113],[2,7,360],[2,8,108],[2,9,132],[2,10,165],[2,11,116],[2,12,149],[2,13,265],[2,14,100],[2,15,144],[2,16,2786],
[3,0,153],[3,1,30],[3,2,112],[3,3,131],[3,4,167],[3,5,205],[3,6,99],[3,7,78],[3,8,22],[3,9,82],[3,10,78],[3,11,112],[3,12,39],[3,13,151],[3,14,146],[3,15,43],[3,16,1648],
[4,0,34],[4,1,207],[4,2,122],[4,3,32],[4,4,27],[4,5,346],[4,6,39],[4,7,109],[4,8,27],[4,9,50],[4,10,36],[4,11,28],[4,12,77],[4,13,105],[4,14,58],[4,15,82],[4,16,1379],
[5,0,8],[5,1,115],[5,2,126],[5,3,58],[5,4,16],[5,5,174],[5,6,30],[5,7,245],[5,8,53],[5,9,25],[5,10,56],[5,11,11],[5,12,73],[5,13,84],[5,14,20],[5,15,74],[5,16,1168],
[6,0,18],[6,1,107],[6,2,122],[6,3,29],[6,4,30],[6,5,113],[6,6,79],[6,7,198],[6,8,64],[6,9,58],[6,10,59],[6,11,38],[6,12,38],[6,13,76],[6,14,61],[6,15,47],[6,16,1137],
[7,0,24],[7,1,104],[7,2,91],[7,3,24],[7,4,29],[7,5,137],[7,6,34],[7,7,115],[7,8,37],[7,9,115],[7,10,18],[7,11,32],[7,12,11],[7,13,43],[7,14,49],[7,15,24],[7,16,887],
[8,0,18],[8,1,96],[8,2,97],[8,3,25],[8,4,25],[8,5,82],[8,6,45],[8,7,49],[8,8,7],[8,9,37],[8,10,16],[8,11,30],[8,12,11],[8,13,41],[8,14,38],[8,15,8],[8,16,625],
[9,0,25],[9,1,102],[9,2,81],[9,3,34],[9,4,23],[9,5,23],[9,6,41],[9,7,78],[9,8,4],[9,9,7],[9,10,1],[9,11,20],[9,12,3],[9,13,23],[9,14,18],[9,15,1],[9,16,484],
[10,0,7],[10,1,36],[10,2,22],[10,3,9],[10,4,11],[10,5,148],[10,6,11],[10,7,20],[10,8,4],[10,9,9],[10,10,2],[10,11,59],[10,12,7],[10,13,66],[10,14,7],[10,15,15],[10,16,433],
[12,0,0],[12,1,6],[12,2,2],[12,3,1],[12,4,2],[12,5,30],[12,6,1],[12,7,26],[12,8,11],[12,9,10],[12,10,8],[12,11,1],[12,12,15],[12,13,16],[12,14,2],[12,15,5],[12,16,136],
[11,0,1],[11,1,8],[11,2,53],[11,3,1],[11,4,1],[11,5,20],[11,6,2],[11,7,20],[11,8,1],[11,9,8],[11,10,5],[11,11,2],[11,12,0],[11,13,2],[11,14,3],[11,15,5],[11,16,132],
[13,0,9],[13,1,5],[13,2,1],[13,3,7],[13,4,18],[13,5,11],[13,6,12],[13,7,7],[13,8,2],[13,9,0],[13,10,1],[13,11,4],[13,12,0],[13,13,4],[13,14,6],[13,15,0],[13,16,87],
[14,0,0],[14,1,5],[14,2,0],[14,3,4],[14,4,4],[14,5,6],[14,6,5],[14,7,2],[14,8,1],[14,9,3],[14,10,2],[14,11,6],[14,12,3],[14,13,9],[14,14,17],[14,15,2],[14,16,69],
[15,0,0],[15,1,5],[15,2,0],[15,3,1],[15,4,1],[15,5,8],[15,6,1],[15,7,5],[15,8,1],[15,9,1],[15,10,1],[15,11,0],[15,12,1],[15,13,1],[15,14,0],[15,15,0],[15,16,26],
[16,0,0],[16,1,2],[16,2,0],[16,3,0],[16,4,3],[16,5,2],[16,6,0],[16,7,5],[16,8,0],[16,9,2],[16,10,8],[16,11,0],[16,12,0],[16,13,0],[16,14,0],[16,15,1],[16,16,23],
[17,0,0],[17,1,3],[17,2,1],[17,3,4],[17,4,1],[17,5,6],[17,6,1],[17,7,1],[17,8,0],[17,9,0],[17,10,0],[17,11,0],[17,12,0],[17,13,0],[17,14,0],[17,15,0],[17,16,17],
[18,0,0],[18,1,0],[18,2,2],[18,3,0],[18,4,1],[18,5,8],[18,6,0],[18,7,0],[18,8,0],[18,9,1],[18,10,0],[18,11,1],[18,12,0],[18,13,1],[18,14,3],[18,15,0],[18,16,17],
[19,0,1],[19,1,0],[19,2,0],[19,3,0],[19,4,1],[19,5,4],[19,6,4],[19,7,0],[19,8,4],[19,9,0],[19,10,1],[19,11,0],[19,12,0],[19,13,0],[19,14,1],[19,15,0],[19,16,16],
[20,0,0],[20,1,1],[20,2,1],[20,3,0],[20,4,0],[20,5,6],[20,6,0],[20,7,1],[20,8,0],[20,9,1],[20,10,0],[20,11,0],[20,12,1],[20,13,1],[20,14,0],[20,15,0],[20,16,12],
[21,0,0],[21,1,3],[21,2,1],[21,3,0],[21,4,0],[21,5,2],[21,6,1],[21,7,0],[21,8,0],[21,9,0],[21,10,0],[21,11,1],[21,12,0],[21,13,1],[21,14,2],[21,15,0],[21,16,11],
[22,0,0],[22,1,0],[22,2,1],[22,3,0],[22,4,0],[22,5,2],[22,6,0],[22,7,1],[22,8,0],[22,9,2],[22,10,0],[22,11,0],[22,12,0],[22,13,0],[22,14,0],[22,15,0],[22,16,6],
[23,0,0],[23,1,0],[23,2,0],[23,3,0],[23,4,0],[23,5,1],[23,6,0],[23,7,0],[23,8,0],[23,9,0],[23,10,0],[23,11,0],[23,12,0],[23,13,0],[23,14,1],[23,15,0],[23,16,2],
[24,0,0],[24,1,0],[24,2,0],[24,3,0],[24,4,0],[24,5,0],[24,6,0],[24,7,0],[24,8,0],[24,9,0],[24,10,0],[24,11,1],[24,12,0],[24,13,1],[24,14,0],[24,15,0],[24,16,2],
[25,0,0],[25,1,1],[25,2,0],[25,3,0],[25,4,0],[25,5,0],[25,6,0],[25,7,0],[25,8,0],[25,9,0],[25,10,0],[25,11,0],[25,12,0],[25,13,0],[25,14,0],[25,15,0],[25,16,1],
[26,0,0],[26,1,0],[26,2,0],[26,3,0],[26,4,0],[26,5,1],[26,6,0],[26,7,0],[26,8,0],[26,9,0],[26,10,0],[26,11,0],[26,12,0],[26,13,0],[26,14,0],[26,15,0],[26,16,1]
		];
		     
		data = data.map(function(item) {
			return [ item[1], item[0], item[2] || '-' ];
		});

		option = {
			title : {
				text : '上海市2011-2015年企业法人主体失信记录来源统计(80万企业)',
				left : 'center'
			},
			grid:{
				left:'15%'
			},
			tooltip : {
				position : 'top',
				formatter : function(obj) {
					var data = obj.data;
					if (obj.name=="小计"){
						return orgMap[obj.data[1]]+"总计： "+obj.data[2];
					}else if(obj.value[1]==0) {
						return obj.name +"失信记录总计： "+ obj.data[2];
					}else{
						return '<div style="border-bottom: 1px solid rgba(255,255,255,.3); font-size: 18px;padding-bottom: 7px;margin-bottom: 7px">'
						+ obj.name
						+( obj.name=="崇明"? "县" :"区")
						+ obj.seriesName
						+ '</div>'
						+ '来源: '
						+ orgMap[obj.data[1]]
						+ '， 数量: '
						+ obj.data[2]
						+ ' <br>';
					}
				
				}
			},
			animation : false,
			xAxis : {
				type : 'category',
				data : days,
			},
			yAxis : {
				type : 'category',
				data : hours
			},
			visualMap : {
				text:['失信记录数',''],
				min : 1,
				max : 100,
				calculable : true,
				orient : 'vertical',
				color : [ '#d94e5d', '#eac736', '#50a3ba' ],
				left : '93%',
				top:'middle'
			},
			series : [ {
				name : '失信记录数',
				type : 'heatmap',
				data : data,
				label : {
					normal : {
						show : true
					}
				}
			} ]
		};

		setTimeout(function()
		{
			myChart.hideLoading();
			myChart.setOption(option);
		}, 1000);
		
	}, 200);
	</script>
</body>

</html>
